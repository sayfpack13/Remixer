<Window x:Class="Remixer.WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Remixer.WPF"
        xmlns:vm="clr-namespace:Remixer.WPF.ViewModels"
        mc:Ignorable="d"
        Title="Audio Remixer" Height="750" Width="1100"
        WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Themes/ModernTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <local:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
            <local:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>
            <local:ProgressToVisibilityConverter x:Key="ProgressToVisibilityConverter"/>
            <local:InvertedBooleanConverter x:Key="InvertedBooleanConverter"/>
            <local:AllTrueToBooleanConverter x:Key="AllTrueToBooleanConverter"/>
        </ResourceDictionary>
    </Window.Resources>
    <Window.Background>
        <StaticResource ResourceKey="BackgroundPrimary"/>
    </Window.Background>
    <Window.DataContext>
        <vm:MainViewModel x:Name="ViewModel"/>
    </Window.DataContext>
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Modern Header -->
        <Border Grid.Row="0" Background="{StaticResource BackgroundElevated}" 
                Padding="20,16" Margin="0,0,0,16" CornerRadius="12">
            <Border.Effect>
                <DropShadowEffect BlurRadius="12" ShadowDepth="4" Opacity="0.15"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock Text="Audio Remixer" Style="{StaticResource Heading1}" Margin="0,0,0,4"/>
                    <TextBlock Text="{Binding CurrentFile}" Style="{StaticResource CaptionText}" 
                               Margin="0,0,0,2" TextTrimming="CharacterEllipsis"/>
                    <TextBlock Text="{Binding AudioFileInfo}" Style="{StaticResource CaptionText}" 
                               Foreground="{StaticResource TextTertiary}"
                               Visibility="{Binding AudioFileInfo, Converter={StaticResource StringToVisibilityConverter}}"
                               TextTrimming="CharacterEllipsis"/>
                </StackPanel>
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Load Audio" Command="{Binding LoadAudioCommand}" 
                            Style="{StaticResource PrimaryButton}" Margin="0,0,8,0"
                            IsEnabled="{Binding IsLoadingAudio, Converter={StaticResource InvertedBooleanConverter}}"/>
                    <Button Content="AI Remix" Command="{Binding AIRemixCommand}" 
                            Style="{StaticResource SuccessButton}" Margin="0,0,8,0"/>
                    <Button Content="Settings" Command="{Binding OpenSettingsCommand}" 
                            Style="{StaticResource SecondaryButton}" Margin="0,0,8,0"
                            IsEnabled="{Binding IsProcessing, Converter={StaticResource InvertedBooleanConverter}}"/>
                    <Button Content="📋 Logs" Command="{Binding OpenLogFolderCommand}" 
                            Style="{StaticResource SecondaryButton}" Margin="0,0,8,0"
                            ToolTip="Open log folder"/>
                    <Button Content="Export" Command="{Binding ExportAudioCommand}" 
                            Style="{StaticResource SecondaryButton}"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Audio Playback Controls -->
        <Border Grid.Row="1" Background="{StaticResource BackgroundSecondary}" 
                CornerRadius="8" Padding="16" Margin="0,0,0,16"
                Visibility="{Binding IsAudioLoaded, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Border.Effect>
                <DropShadowEffect BlurRadius="12" ShadowDepth="4" Opacity="0.15"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Playback Controls -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,12">
                    <Button Content="▶ Play" Command="{Binding PlayCommand}" 
                            Style="{StaticResource SuccessButton}" Width="100" Margin="0,0,8,0"/>
                    <Button Content="⏸ Pause" Command="{Binding PauseCommand}" 
                            Style="{StaticResource SecondaryButton}" Width="100" Margin="0,0,8,0"/>
                    <Button Content="⏹ Stop" Command="{Binding StopCommand}" 
                            Style="{StaticResource DangerButton}" Width="100"/>
                </StackPanel>
                
                <!-- Position Display -->
                <Grid Grid.Row="1" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="{Binding CurrentPosition}" 
                               Style="{StaticResource CaptionText}" VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="2" Text="{Binding TotalDuration}" 
                               Style="{StaticResource CaptionText}" VerticalAlignment="Center"/>
                </Grid>
                
                <!-- Playback Progress Bar -->
                <ProgressBar Grid.Row="2" Value="{Binding PlaybackPosition}" Maximum="100" 
                             Style="{StaticResource ModernProgressBar}"/>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel - Presets -->
            <Border Grid.Column="0" Style="{StaticResource ModernBorder}" Margin="0,0,16,0">
                <StackPanel>
                    <TextBlock Text="Presets" Style="{StaticResource Heading2}" Margin="0,0,0,12"/>
                    <ListBox ItemsSource="{Binding Presets}" SelectedItem="{Binding SelectedPreset}" 
                             Style="{StaticResource ModernListBox}"
                             Height="220" Margin="0,0,0,12">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem" BasedOn="{StaticResource ModernListBoxItem}"/>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding Name}" FontWeight="SemiBold" 
                                               Foreground="{StaticResource TextPrimary}" FontSize="13"/>
                                    <TextBlock Text="{Binding Category}" Style="{StaticResource CaptionText}" Margin="0,2,0,0"/>
                                    <TextBlock Text="{Binding Description}" Style="{StaticResource CaptionText}" 
                                               TextWrapping="Wrap" Margin="0,2,0,0"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <Button Content="Apply Preset" Command="{Binding ApplyPresetCommand}" 
                            Style="{StaticResource PrimaryButton}" Margin="0,0,0,8"/>
                    <Button Content="Save Current as Preset" Command="{Binding SavePresetCommand}" 
                            Style="{StaticResource SuccessButton}" Margin="0,0,0,8"/>
                    <Button Content="Delete Selected Preset" Command="{Binding DeletePresetCommand}" 
                            Style="{StaticResource DangerButton}"/>
                    
                    <!-- Loading Indicator -->
                    <Border Background="{StaticResource BackgroundTertiary}" 
                            CornerRadius="6" Padding="12" Margin="0,12,0,0"
                            Visibility="{Binding IsLoadingAudio, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="⏳" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Loading audio..." Style="{StaticResource BodyText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Processing Indicator -->
                    <Border Background="{StaticResource AccentPrimary}" 
                            CornerRadius="6" Padding="12" Margin="0,12,0,0"
                            Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="⚙️" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Processing..." Style="{StaticResource BodyText}" 
                                       Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- AI Status -->
                    <Separator Margin="0,20,0,12" Background="{StaticResource BorderColor}"/>
                    <TextBlock Text="AI Status" Style="{StaticResource Heading2}" Margin="0,0,0,8"/>
                    <Border Background="{StaticResource BackgroundTertiary}" 
                            CornerRadius="6" Padding="12" Margin="0,0,0,8">
                        <TextBlock Text="{Binding AIStatus}" Style="{StaticResource BodyText}" 
                                   TextWrapping="Wrap"/>
                    </Border>
                    <Border Background="{StaticResource BackgroundTertiary}" 
                            CornerRadius="6" Padding="12"
                            Visibility="{Binding AIReasoning, Converter={StaticResource StringToVisibilityConverter}}">
                        <TextBlock Text="{Binding AIReasoning}" Style="{StaticResource CaptionText}" 
                                   TextWrapping="Wrap"/>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Right Panel - Audio Controls -->
            <ScrollViewer Grid.Column="1" Style="{StaticResource ModernScrollViewer}">
                <StackPanel>
                    <!-- Tempo & Pitch -->
                    <GroupBox Header="Tempo &amp; Pitch" Style="{StaticResource ModernGroupBox}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="60"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Tempo" Grid.Column="0" VerticalAlignment="Center" 
                                           Style="{StaticResource BodyText}"/>
                                <Slider Grid.Column="1" Minimum="0.5" Maximum="2.0" 
                                        Value="{Binding Settings.Tempo, UpdateSourceTrigger=PropertyChanged}" 
                                        Style="{StaticResource ModernSlider}"
                                        TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                <TextBlock Text="{Binding Settings.Tempo, StringFormat='{}{0:F2}x'}" Grid.Column="2" 
                                           VerticalAlignment="Center" HorizontalAlignment="Right"
                                           Style="{StaticResource BodyText}"/>
                            </Grid>
                            <Grid Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="60"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Pitch" Grid.Column="0" VerticalAlignment="Center" 
                                           Style="{StaticResource BodyText}"/>
                                <Slider Grid.Column="1" Minimum="-12" Maximum="12" 
                                        Value="{Binding Settings.Pitch, UpdateSourceTrigger=PropertyChanged}" 
                                        Style="{StaticResource ModernSlider}"
                                        TickFrequency="1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                <TextBlock Text="{Binding Settings.Pitch, StringFormat='{}{0:F0} st'}" Grid.Column="2" 
                                           VerticalAlignment="Center" HorizontalAlignment="Right"
                                           Style="{StaticResource BodyText}"/>
                            </Grid>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="60"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Volume" Grid.Column="0" VerticalAlignment="Center" 
                                           Style="{StaticResource BodyText}"/>
                                <Slider Grid.Column="1" Minimum="0" Maximum="2" 
                                        Value="{Binding Settings.Volume, UpdateSourceTrigger=PropertyChanged}" 
                                        Style="{StaticResource ModernSlider}"
                                        TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                <TextBlock Text="{Binding Settings.Volume, StringFormat='{}{0:F1}'}" Grid.Column="2" 
                                           VerticalAlignment="Center" HorizontalAlignment="Right"
                                           Style="{StaticResource BodyText}"/>
                            </Grid>
                        </StackPanel>
                    </GroupBox>

                    <!-- Reverb -->
                    <GroupBox Header="Reverb" Style="{StaticResource ModernGroupBox}">
                        <GroupBox.IsEnabled>
                            <MultiBinding Converter="{StaticResource AllTrueToBooleanConverter}">
                                <Binding Path="IsAudioLoaded"/>
                                <Binding Path="IsProcessing" Converter="{StaticResource InvertedBooleanConverter}"/>
                                <Binding Path="IsLoadingAudio" Converter="{StaticResource InvertedBooleanConverter}"/>
                            </MultiBinding>
                        </GroupBox.IsEnabled>
                        <StackPanel>
                            <CheckBox Content="Enable Reverb" IsChecked="{Binding Settings.Reverb.Enabled}" 
                                      Style="{StaticResource ModernCheckBox}"/>
                            <Grid IsEnabled="{Binding Settings.Reverb.Enabled}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0" Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Room Size" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="0" Maximum="1" 
                                            Value="{Binding Settings.Reverb.RoomSize, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Reverb.RoomSize, StringFormat='{}{0:F2}'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                                <Grid Grid.Row="1" Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Damping" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="0" Maximum="1" 
                                            Value="{Binding Settings.Reverb.Damping, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Reverb.Damping, StringFormat='{}{0:F2}'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                                <Grid Grid.Row="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Wet Level" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="0" Maximum="1" 
                                            Value="{Binding Settings.Reverb.WetLevel, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Reverb.WetLevel, StringFormat='{}{0:F2}'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                            </Grid>
                        </StackPanel>
                    </GroupBox>

                    <!-- Echo -->
                    <GroupBox Header="Echo / Delay" Style="{StaticResource ModernGroupBox}">
                        <GroupBox.IsEnabled>
                            <MultiBinding Converter="{StaticResource AllTrueToBooleanConverter}">
                                <Binding Path="IsAudioLoaded"/>
                                <Binding Path="IsProcessing" Converter="{StaticResource InvertedBooleanConverter}"/>
                                <Binding Path="IsLoadingAudio" Converter="{StaticResource InvertedBooleanConverter}"/>
                            </MultiBinding>
                        </GroupBox.IsEnabled>
                        <StackPanel>
                            <CheckBox Content="Enable Echo" IsChecked="{Binding Settings.Echo.Enabled}" 
                                      Style="{StaticResource ModernCheckBox}"/>
                            <Grid IsEnabled="{Binding Settings.Echo.Enabled}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0" Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Delay" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="0" Maximum="1" 
                                            Value="{Binding Settings.Echo.Delay, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="0.05" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Echo.Delay, StringFormat='{}{0:F2}s'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                                <Grid Grid.Row="1" Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Feedback" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="0" Maximum="1" 
                                            Value="{Binding Settings.Echo.Feedback, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Echo.Feedback, StringFormat='{}{0:F2}'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                                <Grid Grid.Row="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Wet Level" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="0" Maximum="1" 
                                            Value="{Binding Settings.Echo.WetLevel, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Echo.WetLevel, StringFormat='{}{0:F2}'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                            </Grid>
                        </StackPanel>
                    </GroupBox>

                    <!-- Filter / EQ -->
                    <GroupBox Header="Filter / EQ" Style="{StaticResource ModernGroupBox}">
                        <GroupBox.IsEnabled>
                            <MultiBinding Converter="{StaticResource AllTrueToBooleanConverter}">
                                <Binding Path="IsAudioLoaded"/>
                                <Binding Path="IsProcessing" Converter="{StaticResource InvertedBooleanConverter}"/>
                                <Binding Path="IsLoadingAudio" Converter="{StaticResource InvertedBooleanConverter}"/>
                            </MultiBinding>
                        </GroupBox.IsEnabled>
                        <StackPanel>
                            <CheckBox Content="Enable Filter" IsChecked="{Binding Settings.Filter.Enabled}" 
                                      Style="{StaticResource ModernCheckBox}"/>
                            <Grid IsEnabled="{Binding Settings.Filter.Enabled}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0" Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Low Cut" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="20" Maximum="500" 
                                            Value="{Binding Settings.Filter.LowCut, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="10" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Filter.LowCut, StringFormat='{}{0:F0}Hz'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                                <Grid Grid.Row="1" Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="High Cut" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="5000" Maximum="20000" 
                                            Value="{Binding Settings.Filter.HighCut, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="500" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Filter.HighCut, StringFormat='{}{0:F0}Hz'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                                <Grid Grid.Row="2" Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Low Gain" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="-12" Maximum="12" 
                                            Value="{Binding Settings.Filter.LowGain, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Filter.LowGain, StringFormat='{}{0:F0}dB'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                                <Grid Grid.Row="3" Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Mid Gain" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="-12" Maximum="12" 
                                            Value="{Binding Settings.Filter.MidGain, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Filter.MidGain, StringFormat='{}{0:F0}dB'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                                <Grid Grid.Row="4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="High Gain" Grid.Column="0" VerticalAlignment="Center" 
                                               Style="{StaticResource BodyText}"/>
                                    <Slider Grid.Column="1" Minimum="-12" Maximum="12" 
                                            Value="{Binding Settings.Filter.HighGain, UpdateSourceTrigger=PropertyChanged}" 
                                            Style="{StaticResource ModernSlider}"
                                            TickFrequency="1" IsSnapToTickEnabled="True" Margin="12,0"/>
                                    <TextBlock Text="{Binding Settings.Filter.HighGain, StringFormat='{}{0:F0}dB'}" Grid.Column="2" 
                                               VerticalAlignment="Center" HorizontalAlignment="Right"
                                               Style="{StaticResource BodyText}"/>
                                </Grid>
                            </Grid>
                        </StackPanel>
                    </GroupBox>

                    <!-- AI Indicator -->
                    <Border Background="{StaticResource AccentPrimary}" Padding="16" Margin="0,0,0,0" CornerRadius="8"
                            Visibility="{Binding IsAISet, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.2"/>
                        </Border.Effect>
                        <StackPanel>
                            <TextBlock Text="✨ AI Parameters Applied" FontWeight="SemiBold" 
                                       Foreground="White" FontSize="14" Margin="0,0,0,6"/>
                            <TextBlock Text="These settings were automatically applied by AI. You can override them manually." 
                                       Style="{StaticResource CaptionText}" Foreground="#E0E0E0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- Modern Footer -->
        <Border Grid.Row="3" Background="{StaticResource BackgroundElevated}" 
                Padding="16,12" Margin="0,16,0,0" CornerRadius="8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="240"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Ready" Style="{StaticResource CaptionText}" 
                           VerticalAlignment="Center"/>
                <Border Grid.Column="1" Background="{StaticResource BackgroundTertiary}" 
                        CornerRadius="3" Height="6" 
                        Visibility="{Binding Progress, Converter={StaticResource ProgressToVisibilityConverter}}">
                    <ProgressBar Value="{Binding Progress}" Maximum="100" 
                                 Height="6" Background="Transparent"
                                 Foreground="{StaticResource AccentPrimary}"/>
                </Border>
            </Grid>
        </Border>
    </Grid>
</Window>
